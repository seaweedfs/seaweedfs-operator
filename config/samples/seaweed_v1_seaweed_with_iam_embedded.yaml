apiVersion: seaweed.seaweedfs.com/v1
kind: Seaweed
metadata:
  labels:
    app.kubernetes.io/name: seaweed
    app.kubernetes.io/instance: seaweed-sample
    app.kubernetes.io/part-of: seaweedfs-operator
    app.kubernetes.io/managed-by: kustomize
    app.kubernetes.io/created-by: seaweedfs-operator
  name: seaweed-sample
spec:
  image: chrislusf/seaweedfs:latest

  # Master servers
  master:
    replicas: 1
    volumeSizeLimitMB: 1024

  # Volume servers
  volume:
    replicas: 1

  # Filer servers with S3 and embedded IAM (recommended)
  # IAM API is now embedded in S3 by default (on the same port as S3: 8333)
  # This follows the pattern used by MinIO and Ceph RGW
  filer:
    replicas: 1
    s3:
      enabled: true
    # iam: true  # Optional: IAM is enabled by default when S3 is enabled
    #            # Set to false to explicitly disable embedded IAM
    requests:
      memory: "128Mi"
      cpu: "100m"
    limits:
      memory: "256Mi"
      cpu: "200m"
    service:
      type: ClusterIP

  # Note: The IAM API is accessible on the same port as S3 (8333)
  # No separate IAM service needed when using embedded IAM
